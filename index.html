<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>360-Day Interest Calculator — Premium</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <style>
      :root{
        --bg-1: #081127;
        --bg-2: #071829;
        --card-bg: rgba(255,255,255,0.04);
        --glass-border: rgba(255,255,255,0.08);
        --accent: linear-gradient(90deg,#4f46e5,#06b6d4);
        --glass-blur: 14px;
        --muted: rgba(255,255,255,0.68);
      }
      html,body{height:100%;}
      body{
        font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
        margin:0; min-height:100%; background: radial-gradient(800px 400px at 10% 10%, rgba(12,34,56,0.35), transparent 8%), radial-gradient(600px 360px at 90% 90%, rgba(6,12,32,0.4), transparent 10%), linear-gradient(180deg,var(--bg-1),var(--bg-2));
        color:#e6eef8; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      }

      /* floating accents */
      .accent-blob{ position:fixed; width:520px; height:520px; right:-160px; top:-120px; filter:blur(80px); opacity:0.35; z-index:0; background:radial-gradient(circle at 30% 30%, rgba(99,102,241,0.9), rgba(6,182,212,0.9)); transform:rotate(22deg); }
      .accent-blob.two{ left:-160px; bottom:-140px; background:radial-gradient(circle at 70% 70%, rgba(99,102,241,0.18), rgba(6,182,212,0.18)); }

      .wrap{ min-height:100vh; display:flex; align-items:center; justify-content:center; padding:40px; position:relative; z-index:1 }

      /* Card */
      .panel{
        width:100%; max-width:1100px; padding:26px; border-radius:18px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.015));
        backdrop-filter: blur(var(--glass-blur)); border:1px solid var(--glass-border); box-shadow: 0 18px 50px rgba(3,8,22,0.7);
        display:grid; grid-template-columns: 1fr 420px; gap:20px;
      }

      .panel-left{ padding:10px 6px; }
      .panel-right{ padding:16px; border-radius:12px; background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008)); border:1px solid rgba(255,255,255,0.02); }

      .brand{ display:flex; gap:12px; align-items:center }
      .brand-badge{ width:60px; height:60px; border-radius:12px; display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg,#334155,#0ea5a4); box-shadow: 0 8px 28px rgba(13,27,64,0.6); }
      .brand-badge svg{ filter: drop-shadow(0 8px 30px rgba(0,0,0,0.6)); }
      h1{ font-size:20px; margin:0; font-weight:700 }
      p.lead{ margin:0; color:var(--muted); font-size:13px }

      label.form-label{ color:#d9e9ff; font-weight:600; }
      input.form-control, .form-select{ background: rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.03); color: #e9f2ff; }
      input.form-control::placeholder{ color: rgba(255,255,255,0.45); }
      .form-control:focus{ box-shadow: none; border-color: rgba(79,70,229,0.6); }

      .btn-primary.custom{ background: linear-gradient(90deg,#4f46e5,#06b6d4); border:none; padding:12px 18px; font-weight:700; border-radius:10px; color:#021025 }
      .btn-outline.custom{ background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); border-radius:10px }

      /* Result card styles */
      .stat{ padding:16px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.03); text-align:center }
      .stat .value{ font-weight:800; font-size:1.35rem; margin-top:6px }
      .muted-small{ font-size:13px; color:var(--muted) }

      pre.break{ background: rgba(255,255,255,0.02); padding:14px; border-radius:10px; color:#dff3ff; overflow:auto; max-height:240px; }

      /* small helpers */
      .small-muted { font-size:12px; color:var(--muted) }

      /* Responsive */
      @media (max-width:991px){ .panel{ grid-template-columns: 1fr; } .panel-right{ order: -1 } }

      /* subtle motion */
      .panel{ transform: translateY(12px); opacity:0; animation: lift .6s ease .08s forwards }
      @keyframes lift{ to{ transform:none; opacity:1 } }

      /* subtle badge for method */
      .method-badge { font-size:12px; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.02); color:var(--muted); display:inline-block; margin-bottom:6px; }
    </style>
  </head>
  <body>

    <div class="accent-blob" aria-hidden="true"></div>
    <div class="accent-blob two" aria-hidden="true"></div>

    <main class="wrap">
      <section class="panel">

        <!-- LEFT: Inputs -->
        <div class="panel-left">
          <div class="brand mb-3">
            <div class="brand-badge">
              <!-- icon -->
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 5h18v14H3z" fill="#fff" opacity="0.06"/><path d="M7 9h10v2H7z" fill="#fff" opacity="0.12"/></svg>
            </div>
            <div>
              <h1 id="mainTitle">Interest Calculator — 30/360</h1>
              <p id="mainLead" class="lead">Strict 30-day months. Year = 360 days. Rate shown as ₹ per ₹100 / month.</p>
            </div>
            <div class="ms-auto">
              <select id="lang" class="form-select form-select-sm w-auto" aria-label="Language selector"></select>
            </div>
          </div>

          <form id="calcForm" onsubmit="return false;">
            <div class="row g-3">
              <div class="col-12">
                <label id="lblAmount" class="form-label" for="amount">Principal Amount (₹)</label>
                <input id="amount" type="number" class="form-control" placeholder="e.g. 5000" value="5000" min="0" step="0.01" aria-label="Principal amount">
              </div>

              <div class="col-md-6">
                <label id="lblFrom" class="form-label" for="fromDate">From Date</label>
                <input id="fromDate" type="date" class="form-control" aria-label="From date">
              </div>
              <div class="col-md-6">
                <label id="lblTo" class="form-label" for="toDate">To Date</label>
                <input id="toDate" type="date" class="form-control" aria-label="To date">
              </div>

              <div class="col-12">
                <label id="lblRate" class="form-label" for="rate">Interest Rate (₹ per ₹100 per month)</label>
                <div class="input-group">
                  <input id="rate" type="number" class="form-control" value="2" step="0.01" min="0" aria-label="Rate">
                  <span id="rateSuffix" class="input-group-text">₹ / ₹100 / mo</span>
                </div>
                <div id="helperRate" class="muted-small mt-1">Default: ₹2 per ₹100 per month. Change to adjust.</div>
              </div>

              <div class="col-12">
                <label class="form-label">Calculation Method</label>
                <select id="method" class="form-select">
                  <!-- options will be populated -->
                </select>
                <div class="small-muted mt-1">Pick the day count / interest convention to use for the calculation.</div>
              </div>

              <div class="col-12 d-flex gap-2 justify-content-end mt-2">
                <button id="btnCalc" class="btn btn-primary custom" type="button">Calculate</button>
                <button id="btnReset" type="button" class="btn btn-outline custom">Reset</button>
              </div>
            </div>
          </form>

        </div>

        <!-- RIGHT: Results -->
        <aside class="panel-right">
          <div class="mb-2 d-flex justify-content-between align-items-center">
            <div>
              <div id="resultsLabel" class="muted-small">Results (360-day basis)</div>
              <div class="h5 mb-0" id="resultHeadline">Summary</div>
            </div>
            <div id="eachMonthText" class="text-end muted-small">Each month = 30 days</div>
          </div>

          <div class="row g-3">
            <div class="col-6">
              <div class="stat">
                <div id="lblOutDays" class="muted-small">Total Days</div>
                <div id="outDays" class="value">0</div>
              </div>
            </div>

            <div class="col-6">
              <div class="stat">
                <div id="lblOutMonths" class="muted-small">Total Months</div>
                <div id="outMonths" class="value">0</div>
              </div>
            </div>

            <div class="col-6">
              <div class="stat">
                <div id="lblOutRate" class="muted-small">Monthly Rate (₹/100)</div>
                <div id="outRate" class="value">₹2.00</div>
              </div>
            </div>

            <div class="col-6">
              <div class="stat">
                <div id="lblOutInterest" class="muted-small">Interest</div>
                <div id="outInterest" class="value">₹0.00</div>
              </div>
            </div>

            <div class="col-12">
              <div class="stat">
                <div id="lblOutTotal" class="muted-small">Total Amount (Principal + Interest)</div>
                <div id="outTotal" class="value">₹0.00</div>
              </div>
            </div>

            <div class="col-12">
              <div id="lblBreakdown" class="muted-small mb-2">Calculation Breakdown</div>
              <pre id="breakdown" class="break">—</pre>
            </div>
          </div>

        </aside>

      </section>
    </main>

    <script>
      // ---------- TRANSLATIONS: full deep translations for 15 languages ----------
      const locales = {
        en: {
          code: 'en', name: 'English',
          mainTitle: 'Interest Calculator — 30/360',
          lead: 'Choose method and dates. Rate is shown as ₹ per ₹100 per month.',
          amount: 'Principal Amount (₹)',
          amountPlaceholder: 'e.g. 5000',
          from: 'From Date', to: 'To Date',
          rate: 'Interest Rate (₹ per ₹100 per month)',
          rateSuffix: '₹ / ₹100 / mo',
          helperRate: 'Default: ₹2 per ₹100 per month. Change to adjust.',
          calc: 'Calculate', reset: 'Reset',
          resultsLabel: 'Results',
          summary: 'Summary',
          eachMonth: 'Each month = 30 days',
          outDays: 'Total Days', outMonths: 'Total Months', outRate: 'Monthly Rate (₹/100)',
          outInterest: 'Interest', outTotal: 'Total Amount (Principal + Interest)',
          breakdown: 'Calculation Breakdown',
          alertInvalidAmount: 'Enter a valid principal amount',
          alertSelectDates: 'Select both From and To dates',
          alertToBeforeFrom: 'To Date must be the same as or after From Date',
          daysSuffix: 'days', monthsSuffix: 'months',
          fromLabel: 'From', toLabel: 'To',
          calculationLabel: 'Calculation:',
          methods: {
            bankers30_360: "30/360 (Banker's)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (European)",
            actual_360: "Actual/360",
            actual_365: "Actual/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "Indian Banking (30/360 variant)",
            custom_month: "Custom (months = actual_days / 30)"
          }
        },

        te: {
          code: 'te', name: 'తెలుగు',
          mainTitle: 'వడ్డీ గణకం — 30/360',
          lead: 'పద్ధతిని మరియు తేదీలను ఎంచుకోండి. రేటు ₹100కు నెలకు చూపబడుతుంది.',
          amount: 'మూలధనం (₹)', amountPlaceholder: 'ఉదాహరణ: 5000',
          from: 'ప్రారంభ తేదీ', to: 'ముగింపు తేదీ',
          rate: 'వడ్డీ రేటు (₹100కు నెలకు)', rateSuffix: '₹ / ₹100 / నెల',
          helperRate: 'డిఫాల్ట్: ₹2 ప్రతి ₹100కు నెలకు. మార్చండి.',
          calc: 'లెక్కించు', reset: 'రీసెట్',
          resultsLabel: 'ఫలితాలు', summary: 'సారాంశం', eachMonth: 'ప్రతి నెల = 30 రోజులు',
          outDays: 'మొత్తం రోజులు', outMonths: 'మొత్తం నెలలు', outRate: 'నెలవారీ రేటు (₹/100)', outInterest: 'వడ్డీ', outTotal: 'మొత్తం మొత్తం',
          breakdown: 'లెక్కింపు వివరాలు',
          alertInvalidAmount: 'దయచేసి సరైన మూలధనాన్ని నమోదు చేయండి',
          alertSelectDates: 'దయచేసి రెండు తేదీలను ఎంచుకోండి',
          alertToBeforeFrom: 'ముగింపు తేదీ ప్రారంభ తేదీకి సమానంగా లేదా తరువాతగా ఉండాలి',
          daysSuffix: 'రోజులు', monthsSuffix: 'నెలలు',
          fromLabel: 'ప్రారంభం', toLabel: 'ముగింపు',
          calculationLabel: 'లెక్కింపు:',
          methods: {
            bankers30_360: "30/360 (బ్యాంకర్ల పద్ధతి)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (యూరోపియన్)",
            actual_360: "వాస్తవ/360",
            actual_365: "వాస్తవ/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "భారత బ్యాంకింగ్ (30/360 వేరియంట్)",
            custom_month: "కస్టమ్ (నెలలు = వాస్తవ_రోజులు/30)"
          }
        },

        hi: {
          code: 'hi', name: 'हिन्दी',
          mainTitle: 'ब्याज कैलकुलेटर — 30/360',
          lead: 'मेथड और तारीखें चुनें। दर ₹100 पर प्रति माह दिखाई जाती है।',
          amount: 'मूल राशी (₹)', amountPlaceholder: 'उदा: 5000',
          from: 'प्रारंभ तिथि', to: 'समाप्ति तिथि',
          rate: 'ब्याज दर (₹100 के लिए प्रति माह)', rateSuffix: '₹ / ₹100 / माह',
          helperRate: 'डिफ़ॉल्ट: ₹2 प्रति ₹100 प्रति माह। समायोजित करें।',
          calc: 'गणना करें', reset: 'रीसेट',
          resultsLabel: 'परिणाम', summary: 'सारांश', eachMonth: 'प्रति माह = 30 दिन',
          outDays: 'कुल दिन', outMonths: 'कुल महीने', outRate: 'मासिक दर (₹/100)', outInterest: 'ब्याज', outTotal: 'कुल राशि',
          breakdown: 'गणना विवरण',
          alertInvalidAmount: 'कृपया मान्य मूल राशी दर्ज करें',
          alertSelectDates: 'कृपया दोनों तिथियाँ चुनें',
          alertToBeforeFrom: 'समाप्ति तिथि प्रारंभ तिथि के समान या बाद में होनी चाहिए',
          daysSuffix: 'दिन', monthsSuffix: 'महीने',
          fromLabel: 'प्रारंभ', toLabel: 'समाप्ति',
          calculationLabel: 'गणना:',
          methods: {
            bankers30_360: "30/360 (बैंकर का तरीका)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (यूरोपीय)",
            actual_360: "वास्तविक/360",
            actual_365: "वास्तविक/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "भारतीय बैंकिंग (30/360 प्रकार)",
            custom_month: "कस्टम (महीने = वास्तविक_दिन / 30)"
          }
        },

        ta: {
          code: 'ta', name: 'தமிழ்',
          mainTitle: 'வட்டி கணக்கீடு — 30/360',
          lead: 'முறையையும் தேதிகளையும் தேர்வு செய்க. விகிதம் ₹100க்கு மாதத்திற்கு காட்டப்படும்.',
          amount: 'மூலதனம் (₹)', amountPlaceholder: 'உதா: 5000',
          from: 'தொடக்க தேதி', to: 'முடிவு தேதி',
          rate: 'வட்டி விகிதம் (₹100க்கு மாதம்)', rateSuffix: '₹ / ₹100 / மாதம்',
          helperRate: 'இயல்புநிலை: ₹2 प्रति ₹100 மாதம். மாற்றவும்.',
          calc: 'கணக்கிடு', reset: 'மீட்டமை',
          resultsLabel: ' முடிவுகள்', summary: 'சுருக்கம்', eachMonth: 'ஒரு மாதம் = 30 நாட்கள்',
          outDays: 'மொத்த நாட்கள்', outMonths: 'மொத்த மாதங்கள்', outRate: 'மாத விகிதம் (₹/100)', outInterest: 'வட்டி', outTotal: 'மொத்த தொகை',
          breakdown: 'கணக்கீட்டு விவரம்',
          alertInvalidAmount: 'தயவுசெய்து செல்லுபடியாகும் தொகையை உள்ளிடவும்',
          alertSelectDates: 'தயவுச்செய்து இரு தேதிகளையும் தேர்வு செய்யவும்',
          alertToBeforeFrom: 'முடிவு தேதி தொடக்க தேதி அல்லது அதற்குப்பிறகு இருக்க வேண்டும்',
          daysSuffix: 'நாட்கள்', monthsSuffix: 'மாதங்கள்',
          fromLabel: 'தொடக்கம்', toLabel: 'முடிவு',
          calculationLabel: 'கணக்கீடு:',
          methods: {
            bankers30_360: "30/360 (வங்கி முறை)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (ஐரோப்பிய)",
            actual_360: "உண்மை/360",
            actual_365: "உண்மை/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "இந்திய பேங்கிங் (30/360 வகை)",
            custom_month: "தனிப்பயன் (மாதங்கள் = உண்மை_தினங்கள்/30)"
          }
        },

        kn: {
          code: 'kn', name: 'ಕನ್ನಡ',
          mainTitle: 'ಬಡ್ಡಿ ಕ್ಯಾಲ್ಕುಲೇಟರ್ — 30/360',
          lead: 'ವಿಧಾನ ಮತ್ತು ದಿನಾಂಕಗಳನ್ನು ಆಯ್ಕೆಮಾಡಿ. ದರವನ್ನು ₹100ಕ್ಕೆ ತಿಂಗಳಿಗೆ ತೋರಿಸಲಾಗುತ್ತದೆ.',
          amount: 'ಮುಖ್ಯ ಮೊತ್ತ (₹)', amountPlaceholder: 'ಉದಾ: 5000',
          from: 'ಆರಂಭ ದಿನಾಂಕ', to: 'ಅಂತಿಮ ದಿನಾಂಕ',
          rate: 'ಬಡ್ಡಿ ದರ (₹100ಗೆ ತಿಂಗಳಿಗೆ)', rateSuffix: '₹ / ₹100 / ತಿಂಗಳು',
          helperRate: 'ಡೀಫಾಲ್ಟ್: ₹2 ಪ್ರತಿ ₹100 ತಿಂಗಳಿಗೆ. ಹೊಂದಿಸಿ.',
          calc: 'ಲೆಕ್ಕಿಸಿ', reset: 'ರಿಸೆಟ್',
          resultsLabel: 'ಫಲಿತಾಂಶಗಳು', summary: 'ಸಾರಾಂಶ', eachMonth: 'ಪ್ರತಿ ತಿಂಗಳು = 30 ದಿನಗಳು',
          outDays: 'ಒಟ್ಟು ದಿನಗಳು', outMonths: 'ಒಟ್ಟು ತಿಂಗಳು', outRate: 'ತಿಂಗಳ ದರ (₹/100)', outInterest: 'ಬಡ್ಡಿ', outTotal: 'ಒಟ್ಟು ಮೊತ್ತ',
          breakdown: 'ಲೆಕ್ಕಿಸುವ ವಿವರ',
          alertInvalidAmount: 'ದಯವಿಟ್ಟು ಮಾನ್ಯ ಮೊತ್ತ ನಮೀದಿ',
          alertSelectDates: 'ದಯವಿಟ್ಟು ಎರಡು ದಿನಾಂಕಗಳನ್ನು ಆರಿಸಿ',
          alertToBeforeFrom: 'ಅಂತಿಮ ದಿನಾಂಕವು ಪ್ರಾರಂಭದ ದಿನಾಂಕದಂತೆ ಅಥವಾ ನಂತರವಾಗಿರಲಿ',
          daysSuffix: 'ದಿನಗಳು', monthsSuffix: 'ತಿಂಗಳು',
          fromLabel: 'ಆರಂಭ', toLabel: 'ಅಂತ್ಯ',
          calculationLabel: 'ಲೆಕ್ಕಾಚಾರ:',
          methods: {
            bankers30_360: "30/360 (ಬ್ಯಾಂಕರ್ ಪದ್ದತಿ)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (ಯುರೋಪಿಯನ್)",
            actual_360: "ವಾಸ್ತವ/360",
            actual_365: "ವಾಸ್ತವ/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "ಭಾರತೀಯ ಬ್ಯಾಂಕಿಂಗ್ (30/360 ವಿಧ)",
            custom_month: "ಕಸ್ಟಮ್ (ತಿಂಗಳು = ವಾಸ್ತವ_ದಿನಗಳು/30)"
          }
        },

        ml: {
          code: 'ml', name: 'മലയാളം',
          mainTitle: 'പലിശ കാൽക്കുലേറ്റർ — 30/360',
          lead: 'രീതി ಮತ್ತು തീയതികൾ തിരഞ്ഞെടുക്കുക. നിരക്ക് ₹100ക്ക് പ്രതി മാസം കാണിക്കുന്നു.',
          amount: 'പ്രധാന തുക (₹)', amountPlaceholder: 'ഉദാ: 5000',
          from: 'ആരംഭ തീയതി', to: 'അവസാന തീയതി',
          rate: 'പലിശ നിരക്ക് (₹100ക്ക് പ്രതി മാസം)', rateSuffix: '₹ / ₹100 / മാസം',
          helperRate: 'ഡീഫോൾട്ട്: ₹2 प्रति ₹100 മാസം. ക്രമീകരിക്കുക.',
          calc: 'പലിശ കണക്കുക', reset: 'റീസെറ്റ്',
          resultsLabel: 'ഫലങ്ങൾ', summary: 'സാരാംശം', eachMonth: 'ഓരോ മാസം = 30 ദിവസം',
          outDays: 'മൊത്തം ദിവസങ്ങൾ', outMonths: 'മൊത്തം മാസം', outRate: 'മാസ നിരക്ക് (₹/100)', outInterest: 'പലിശ', outTotal: 'മൊത്തം തുക',
          breakdown: 'കണക്കുകൾ വിവരണം',
          alertInvalidAmount: 'ദയവായി ശരിയായ തുക നൽകുക',
          alertSelectDates: 'ദയവായി രണ്ടു തീയതികളും തിരഞ്ഞെടുക്കുക',
          alertToBeforeFrom: 'അവസാന തീയതി ആരംഭ തീയതിക്കു സമം അല്ലെങ്കിൽ ശേഷം ആയിരിക്കണം',
          daysSuffix: 'ദിവസങ്ങൾ', monthsSuffix: 'മാസങ്ങൾ',
          fromLabel: 'ആരംഭം', toLabel: 'അവസാനം',
          calculationLabel: 'കണക്കുകൂട്ടൽ:',
          methods: {
            bankers30_360: "30/360 (ബാങ്കറിന്റെ രീതിയുടെ)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (യൂറോപ്യൻ)",
            actual_360: "യഥാർത്ഥം/360",
            actual_365: "യഥാർത്ഥം/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "ഇന്ത്യൻ ബാങ്കിംഗ് (30/360 വകഭേദം)",
            custom_month: "കസ്റ്റം (മാസങ്ങൾ = യഥാർത്ഥ_ദിനങ്ങൾ/30)"
          }
        },

        mr: {
          code: 'mr', name: 'मराठी',
          mainTitle: 'व्याज कॅल्क्युलेटर — 30/360',
          lead: 'पद्धत व तारीख निवडा. दर ₹100 साठी प्रति महिना दर्शविला जातो.',
          amount: 'मुख्य रक्कम (₹)', amountPlaceholder: 'उदा: 5000',
          from: 'पासून तारीख', to: 'पर्यंत तारीख',
          rate: 'व्याज दर (₹100 साठी प्रति महिना)', rateSuffix: '₹ / ₹100 / महि',
          helperRate: 'डिफॉल्ट: ₹2 प्रति ₹100 प्रति महिना. बदल करा.',
          calc: 'गणना', reset: 'रीसेट',
          resultsLabel: 'परिणाम', summary: 'सारांश', eachMonth: 'प्रत्येक महिना = 30 दिवस',
          outDays: 'एकूण दिवस', outMonths: 'एकूण महिने', outRate: 'मासिक दर (₹/100)', outInterest: 'व्याज', outTotal: 'एकूण रक्कम',
          breakdown: 'गणना तपशील',
          alertInvalidAmount: 'कृपया वैध रक्कम प्रविष्ट करा',
          alertSelectDates: 'कृपया दोन्ही तारखा निवडा',
          alertToBeforeFrom: 'पर्यंत तारीख ते सुरू तारीख किंवा नंतर असावी',
          daysSuffix: 'दिवस', monthsSuffix: 'महिने',
          fromLabel: 'पासून', toLabel: 'पर्यंत',
          calculationLabel: 'गणना:',
          methods: {
            bankers30_360: "30/360 (बँकर्स)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (युरोपियन)",
            actual_360: "अॅक्टुअल/360",
            actual_365: "अॅक्टुअल/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "भारतीय बँकिंग (30/360 प्रकार)",
            custom_month: "कस्टम (महिने = अ‍ॅक्टुअल_दिवस/30)"
          }
        },

        gu: {
          code: 'gu', name: 'ગુજરાતી',
          mainTitle: 'બ્યાર કેટલક્યુલેટર — 30/360',
          lead: 'પદ્ધતિ અને તારીખ પસંદ કરો. દર ₹100 માટે પ્રતિ મહિનો બતાવવામાં આવે છે.',
          amount: 'મૂળ રકમ (₹)', amountPlaceholder: 'ઉદાહરણ: 5000',
          from: 'પ્રારંભ તારીખ', to: 'સમાપ્તિ તારીખ',
          rate: 'વજ્ર દર (₹100 માટે પ્રતિ મહિનો)', rateSuffix: '₹ / ₹100 / મહિ',
          helperRate: 'ડિફોલ્ટ: ₹2 પ્રતિ ₹100 પ્રતિ મહિનો. બદલો.',
          calc: 'ગણવેશો', reset: 'રીસેટ',
          resultsLabel: 'પરિણામો', summary: 'સારાંશ', eachMonth: 'દર મહિનો = 30 દિવસ',
          outDays: 'કુલ દિવસો', outMonths: 'કુલ મહિના', outRate: 'માસિક દર (₹/100)', outInterest: 'બ્યાર', outTotal: 'કુલ રકમ',
          breakdown: 'ગણતરી વિગતો',
          alertInvalidAmount: 'કૃપા કરી માન્ય રકમ દાખલ કરો',
          alertSelectDates: 'કૃપા કરી બંને તારીખો પસંદ કરો',
          alertToBeforeFrom: 'અંત તારીખ શરૂઆતની તારીખથી સમાન અથવા પછી હોવી જ જોઈએ',
          daysSuffix: 'દિવસ', monthsSuffix: 'મહિના',
          fromLabel: 'થી', toLabel: 'પર્યંત',
          calculationLabel: 'ગણતરી:',
          methods: {
            bankers30_360: "30/360 (બેનકર્સ)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (યુરોપિયન)",
            actual_360: "એક્યુઅલ/360",
            actual_365: "એક્યુઅલ/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "ઇન્ડિયન બેન્કિંગ (30/360 પ્રકાર)",
            custom_month: "કસ્ટમ (મહિના = રિયલ_દિવસ/30)"
          }
        },

        bn: {
          code: 'bn', name: 'বাংলা',
          mainTitle: 'সুদ গণক — 30/360',
          lead: 'পদ্ধতি ও তারিখ নির্বাচন করুন। হারটি ₹100 প্রতি মাসে দেখানো হয়।',
          amount: 'মূল পরিমাণ (₹)', amountPlaceholder: 'উদাহরণ: 5000',
          from: 'শুরু তারিখ', to: 'শেষ তারিখ',
          rate: 'সুদ হার (₹100 প্রতি মাসে)', rateSuffix: '₹ / ₹100 / মাস',
          helperRate: 'ডিফল্ট: ₹2 প্রতি ₹100 প্রতি মাসে। পরিবর্তন করুন।',
          calc: 'গণনা', reset: 'রিসেট',
          resultsLabel: 'ফলাফল', summary: 'সারসংক্ষেপ', eachMonth: 'প্রতি মাস = 30 দিন',
          outDays: 'মোট দিন', outMonths: 'মোট মাস', outRate: 'মাসিক হার (₹/100)', outInterest: 'সুদ', outTotal: 'মোট পরিমাণ',
          breakdown: 'গণনার বিস্তারিত',
          alertInvalidAmount: 'অনুগ্রহ করে একটি বৈধ পরিমাণ লিখুন',
          alertSelectDates: 'অনুগ্রহ করে উভয় তারিখ নির্বাচন করুন',
          alertToBeforeFrom: 'শেষ তারিখ শুরু তারিখের সমান বা পরবর্তীতে হতে হবে',
          daysSuffix: 'দিন', monthsSuffix: 'মাস',
          fromLabel: 'থেকে', toLabel: 'পর্যন্ত',
          calculationLabel: 'গণনা:',
          methods: {
            bankers30_360: "30/360 (ব্যাঙ্কারের)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (ইউরোপীয়)",
            actual_360: "এ্যাকচুয়াল/360",
            actual_365: "এ্যাকচুয়াল/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "ভারতীয় ব্যাঙ্কিং (30/360 ধাঁচ)",
            custom_month: "কাস্টম (মাস = বাস্তব_দিন/30)"
          }
        },

        pa: {
          code: 'pa', name: 'ਪੰਜਾਬੀ',
          mainTitle: 'ਸੁਦ ਕੈਲਕੁਲੇਟਰ — 30/360',
          lead: 'ਤਰੀਕਾ ਅਤੇ ਤਾਰੀਖਾਂ ਚੁਣੋ। ਦਰ ₹100 ਲਈ ਪ੍ਰਤੀ ਮਹੀਨਾ ਦਿਖਾਈ ਜਾਂਦੀ ਹੈ।',
          amount: 'ਮੂਲ ਰਕਮ (₹)', amountPlaceholder: 'ਉਦਾਹਰਣ: 5000',
          from: 'ਸ਼ੁਰੂ ਦੀ ਤਾਰੀਖ', to: 'ਅੰਤ ਤਾਰੀਖ',
          rate: 'ਸੁਦ ਦਰ (₹100 ਲਈ ਪ੍ਰਤੀ ਮਹੀਨਾ)', rateSuffix: '₹ / ₹100 / ਮਹੀ',
          helperRate: 'ਡਿਫਾਲਟ: ₹2 ਪ੍ਰਤੀ ₹100 ਪ੍ਰਤੀ ਮਹੀਨਾ। ਢਾਲੋ।',
          calc: 'ਗਣਨਾ', reset: 'ਰੀਸੈੱਟ',
          resultsLabel: 'ਨਤੀਜੇ', summary: 'ਸਾਰ', eachMonth: 'ਹਰੇਕ ਮਹੀਨਾ = 30 ਦਿਨ',
          outDays: 'ਕੁੱਲ ਦਿਨ', outMonths: 'ਕੁੱਲ ਮਹੀਨੇ', outRate: 'ਮਾਸਿਕ ਦਰ (₹/100)', outInterest: 'ਸੁਦ', outTotal: 'ਕੁੱਲ ਰਕਮ',
          breakdown: 'ਗਣਨਾ ਵੇਰਵਾ',
          alertInvalidAmount: 'ਕਿਰਪਾ ਕਰਕੇ ਵੈਧ ਰਕਮ ਦਾਖਲ ਕਰੋ',
          alertSelectDates: 'ਕਿਰਪਾ ਕਰਕੇ ਦੋਹਾਂ ਤਰੀਕਾਂ ਚੁਣੋ',
          alertToBeforeFrom: 'ਅੰਤ ਤਾਰੀਖ ਸ਼ੁਰੂ ਤਾਰੀਖ ਦੇ ਬਰਾਬਰ ਜਾਂ ਬਾਅਦ ਹੋਣੀ ਚਾਹੀਦੀ ਹੈ',
          daysSuffix: 'ਦਿਨ', monthsSuffix: 'ਮਹੀਨੇ',
          fromLabel: 'ਤੋਂ', toLabel: 'ਤੱਕ',
          calculationLabel: 'ਗਣਨਾ:',
          methods: {
            bankers30_360: "30/360 (ਬੈਂਕਰ)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (ਯੂਰੋਪੀਅਨ)",
            actual_360: "ਵਾਸਤਵ/360",
            actual_365: "ਵਾਸਤਵ/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "ਭਾਰਤੀ ਬੈਂਕਿੰਗ (30/360 ਵਰਜਨ)",
            custom_month: "ਕਸਟਮ (ਮਹੀਨੇ = ਵਾਸਤਵ_ਦਿਨ/30)"
          }
        },

        or: {
          code: 'or', name: 'ଓଡ଼ିଆ',
          mainTitle: 'ସୁଦ ଗଣକ — 30/360',
          lead: 'ପদ্ধତି ଏବଂ ତାରିख ଚୟନ କରନ୍ତୁ। ହାର ₹100 ପାଇଁ ପ୍ରତି ମାସ ଦେଖାଯାଏ।',
          amount: 'ମୂଳ ରାଶି (₹)', amountPlaceholder: 'ଉଦାହରଣ: 5000',
          from: 'ଆରମ୍ଭ ତାରିଖ', to: 'ଶେଷ ତାରିଖ',
          rate: 'ସୁଦ ହାର (₹100 ପାଇଁ ପ୍ରତି ମାସ)', rateSuffix: '₹ / ₹100 / ମାସ',
          helperRate: 'ଡିଫଲ୍ଟ: ₹2 ପ୍ରତି ₹100 ପ୍ରତି ମାସ। ପରିବର୍ତ୍ତନ କରନ୍ତୁ।',
          calc: 'ଗଣନା', reset: 'ରିସେଟ',
          resultsLabel: 'ଫଳାଫଳ', summary: 'ସାରାଂଶ', eachMonth: 'ପ୍ରତି ମାସ = 30 ଦିନ',
          outDays: 'ମୋଟ ଦିନ', outMonths: 'ମୋଟ ମାସ', outRate: 'ମାସିକ ହାର (₹/100)', outInterest: 'ସୁଦ', outTotal: 'ମୋଟ ରାଶି',
          breakdown: 'ଗଣନା ବିବରଣୀ',
          alertInvalidAmount: 'ଦୟାକରି ଏକ ବୈଧ ରାଶି ଲେଖନ୍ତୁ',
          alertSelectDates: 'ଦୟାକରି ଦୁଇଟି ତାରିଖ ଚୟନ କରନ୍ତୁ',
          alertToBeforeFrom: 'ଶେଷ ତାରିଖ ଆରମ୍ଭ ତାରିଖ ସମାନ କିମ୍ବା ପରେ ହେବା ଉଚିତ୍',
          daysSuffix: 'ଦିନ', monthsSuffix: 'ମାସ',
          fromLabel: 'ରୁ', toLabel: 'ପର୍ଯ୍ୟନ୍ତ',
          calculationLabel: 'ଗଣନା:',
          methods: {
            bankers30_360: "30/360 (ବ୍ୟାଙ୍କର୍ସ)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (ୟୁରୋପିୟନ)",
            actual_360: "ଏକ୍ଚୁଆଲ/360",
            actual_365: "ଏକ୍ଚୁଆଲ/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "ଭାରତୀୟ ବ୍ୟାଙ୍କିଙ୍ଗ (30/360 ବିଭେଦ)",
            custom_month: "କଷ୍ଟମ୍ (ମାସ = ଏକ୍ଚୁଆଲ_ଦିନ/30)"
          }
        },

        ur: {
          code: 'ur', name: 'اردو',
          mainTitle: 'سود کیلکولیٹر — 30/360',
          lead: 'طریقہ اور تاریخیں منتخب کریں۔ شرح ₹100 کے لیے ماہانہ دکھائی جاتی ہے۔',
          amount: 'اصل رقم (₹)', amountPlaceholder: 'مثال: 5000',
          from: 'شروع تاریخ', to: 'ختم ہونے کی تاریخ',
          rate: 'سود کی شرح (₹100 کے لیے ماہانہ)', rateSuffix: '₹ / ₹100 / ماہ',
          helperRate: 'پہلے سے طے شدہ: ₹2 فی ₹100 فی ماہ. تبدیل کریں۔',
          calc: 'حساب کریں', reset: 'ری سیٹ',
          resultsLabel: 'نتائج', summary: 'خلاصہ', eachMonth: 'ہر ماہ = 30 دن',
          outDays: 'کل دن', outMonths: 'کل مہینے', outRate: 'ماہانہ شرح (₹/100)', outInterest: 'سود', outTotal: 'کل رقم',
          breakdown: 'حساب کی تفصیل',
          alertInvalidAmount: 'براہ کرم درست رقم درج کریں',
          alertSelectDates: 'براہ کرم دونوں تاریخیں منتخب کریں',
          alertToBeforeFrom: 'ختم ہونے کی تاریخ شروع کی تاریخ کے برابر یا بعد ہونی چاہئے',
          daysSuffix: 'دن', monthsSuffix: 'مہینے',
          fromLabel: 'شروع', toLabel: 'ختم',
          calculationLabel: 'حساب:',
          methods: {
            bankers30_360: "30/360 (بینکرز)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (یورپی)",
            actual_360: "اصل/360",
            actual_365: "اصل/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "ہندوستانی بینکنگ (30/360 قسم)",
            custom_month: "کسٹم (مہینے = اصل_دن/30)"
          }
        },

        si: {
          code: 'si', name: 'සිංහල',
          mainTitle: 'වාInterest ගණකය — 30/360',
          lead: 'විධිය සහ දිනයන් තෝරන්න. අනුපාතිකය ₹100ට මාසිකව පෙන්වයි.',
          amount: 'ප්‍රධාන එකතුව (₹)', amountPlaceholder: 'උදා: 5000',
          from: 'සිට දිනය', to: 'වටින දිනය',
          rate: 'වුද්ධි අනුපාතිකය (₹100 කට මාසික)', rateSuffix: '₹ / ₹100 / මාස',
          helperRate: ' පෙරනිමි: ₹2 ප්‍රති ₹100 මාසිකව. වෙනස් කරන්න.',
          calc: 'ගණනය', reset: 'රිසෙට්',
          resultsLabel: 'ප්‍රතිඵල', summary: 'සාරාංශය', eachMonth: 'සෑම මාසෙකම = 30 දින',
          outDays: 'සම්පූර්ණ දින', outMonths: 'සම්පූර්ණ මාස', outRate: 'මාසික අනුපාතිකය (₹/100)', outInterest: 'වෙනු', outTotal: 'සම්පූර්ණ මුලුතැන්ගෙය',
          breakdown: 'ගණනය විස්තර',
          alertInvalidAmount: 'කරුණාකර වලංගු මුදලක් ඇතුළත් කරන්න',
          alertSelectDates: 'කරුණාකර දෙවැනි දිනයන් තෝරන්න',
          alertToBeforeFrom: 'අවසාන දිනය ආරම්භක දිනයට සමාන හෝ පසු විය යුතුය',
          daysSuffix: 'දින', monthsSuffix: 'මාස',
          fromLabel: 'සිට', toLabel: 'පසු',
          calculationLabel: 'ගණනය:',
          methods: {
            bankers30_360: "30/360 (බැංකු නිලධාරී)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (යුරෝපියානු)",
            actual_360: "යථාර්ථ/360",
            actual_365: "යථාර්ථ/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "ඉන්දියානු බැංකු (30/360 විකල්ප)",
            custom_month: "අභිරුචි (මාස = යථාර්ථ_දිනයන්/30)"
          }
        },

        ne: {
          code: 'ne', name: 'नेपाली',
          mainTitle: 'ब्याज क्याल्कुलेटर — 30/360',
          lead: 'विधि र मिति छान्नुहोस्। दर ₹100 प्रति महिना देखाइन्छ।',
          amount: 'प्रमुख रकम (₹)', amountPlaceholder: 'जस्तै: 5000',
          from: 'देखि मिति', to: 'सम्म मिति',
          rate: 'ब्याज दर (₹100 प्रति महिना)', rateSuffix: '₹ / ₹100 / महिना',
          helperRate: 'पूर्वनिर्धारित: ₹2 प्रति ₹100 प्रति महिना। परिवर्तन गर्नुहोस्।',
          calc: 'गणना', reset: 'रिसेट',
          resultsLabel: 'नतीजा', summary: 'सारांश', eachMonth: 'प्रत्येक महिना = 30 दिन',
          outDays: 'कुल दिन', outMonths: 'कुल महिना', outRate: 'मासिक दर (₹/100)', outInterest: 'ब्याज', outTotal: 'कुल रकम',
          breakdown: 'गणना विवरण',
          alertInvalidAmount: 'कृपया मान्य रकम प्रविष्ट गर्नुहोस्',
          alertSelectDates: 'कृपया दुवै मिति छान्नुहोस्',
          alertToBeforeFrom: 'तीन मिति शुरू मिति भन्दा बराबर वा पछि हुनुपर्छ',
          daysSuffix: 'दिन', monthsSuffix: 'महिना',
          fromLabel: 'देखि', toLabel: 'सम्म',
          calculationLabel: 'गणना:',
          methods: {
            bankers30_360: "30/360 (ब्यांकरको)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (यूरोपियन)",
            actual_360: "वास्तविक/360",
            actual_365: "वास्तविक/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "भारतीय बैंकिङ (30/360 प्रकार)",
            custom_month: "कस्टम (महिना = वास्तविक_दिन/30)"
          }
        },

        es: {
          code: 'es', name: 'Español',
          mainTitle: 'Calculadora de Interés — 30/360',
          lead: 'Elija el método y las fechas. La tasa se muestra como ₹ por ₹100 por mes.',
          amount: 'Importe Principal (₹)', amountPlaceholder: 'p.ej. 5000',
          from: 'Fecha Desde', to: 'Fecha Hasta',
          rate: 'Tasa de Interés (₹ por ₹100 por mes)', rateSuffix: '₹ / ₹100 / mes',
          helperRate: 'Por defecto: ₹2 por ₹100 por mes. Cambie si desea.',
          calc: 'Calcular', reset: 'Reiniciar',
          resultsLabel: 'Resultados', summary: 'Resumen', eachMonth: 'Cada mes = 30 días',
          outDays: 'Días Totales', outMonths: 'Meses Totales', outRate: 'Tasa Mensual (₹/100)', outInterest: 'Interés', outTotal: 'Importe Total',
          breakdown: 'Desglose del Cálculo',
          alertInvalidAmount: 'Introduce una cantidad principal válida',
          alertSelectDates: 'Selecciona ambas fechas Desde y Hasta',
          alertToBeforeFrom: 'La fecha Hasta debe ser igual o posterior a la fecha Desde',
          daysSuffix: 'días', monthsSuffix: 'meses',
          fromLabel: 'Desde', toLabel: 'Hasta',
          calculationLabel: 'Cálculo:',
          methods: {
            bankers30_360: "30/360 (Banco)",
            us30_360: "30/360 US (NASD)",
            euro30_360: "30E/360 (Europeo)",
            actual_360: "Actual/360",
            actual_365: "Actual/365",
            act_act: "ACT/ACT (ISDA)",
            indian_bank: "Banca India (variante 30/360)",
            custom_month: "Personalizado (meses = días_actuales / 30)"
          }
        }
      };

      // Populate language dropdown
      const langSelect = document.getElementById('lang');
      Object.values(locales).forEach(loc => {
        const opt = document.createElement('option');
        opt.value = loc.code; opt.text = loc.name;
        langSelect.appendChild(opt);
      });

      // Methods list (keys correspond to locale method keys)
      const methodsList = [
        { key: 'bankers30_360', id: 'bankers30_360' },
        { key: 'us30_360', id: 'us30_360' },
        { key: 'euro30_360', id: 'euro30_360' },
        { key: 'actual_360', id: 'actual_360' },
        { key: 'actual_365', id: 'actual_365' },
        { key: 'act_act', id: 'act_act' },
        { key: 'indian_bank', id: 'indian_bank' },
        { key: 'custom_month', id: 'custom_month' }
      ];

      function populateMethods() {
        const sel = document.getElementById('method');
        sel.innerHTML = '';
        const cur = locales[localLang()] || locales.en;
        Object.keys(cur.methods).forEach(k => {
          const o = document.createElement('option');
          o.value = k; o.text = cur.methods[k];
          sel.appendChild(o);
        });
      }

      function localLang(){ return (langSelect.value || 'en'); }

      // Apply language translations (full)
      function applyLang(code) {
        const t = locales[code] || locales.en;

        document.getElementById('mainTitle').innerText = t.mainTitle;
        document.getElementById('mainLead').innerText = t.lead;
        document.getElementById('lblAmount').innerText = t.amount;
        document.getElementById('amount').placeholder = t.amountPlaceholder || '';
        document.getElementById('lblFrom').innerText = t.from;
        document.getElementById('lblTo').innerText = t.to;
        document.getElementById('lblRate').innerText = t.rate;
        document.getElementById('rateSuffix').innerText = t.rateSuffix;
        document.getElementById('helperRate').innerText = t.helperRate;
        document.getElementById('btnCalc').innerText = t.calc;
        document.getElementById('btnReset').innerText = t.reset;
        document.getElementById('resultsLabel').innerText = t.resultsLabel;
        document.getElementById('resultHeadline').innerText = t.summary;
        document.getElementById('eachMonthText').innerText = t.eachMonth;
        document.getElementById('lblOutDays').innerText = t.outDays;
        document.getElementById('lblOutMonths').innerText = t.outMonths;
        document.getElementById('lblOutRate').innerText = t.outRate;
        document.getElementById('lblOutInterest').innerText = t.outInterest;
        document.getElementById('lblOutTotal').innerText = t.outTotal;
        document.getElementById('lblBreakdown').innerText = t.breakdown;

        populateMethods();
      }

      // set defaults
      langSelect.value = 'en';
      applyLang('en');

      // Update when language changes
      langSelect.addEventListener('change', (e) => applyLang(e.target.value));

      // ---------- Calculation helpers for different day-count conventions ----------
      function daysBetweenActual(fd, td) {
        const one = 24*60*60*1000;
        return Math.round((td - fd) / one);
      }

      // 30/360 Banker's (European bankers / ISDA style: adjust feb? We'll implement strict: cap days >30? original spec)
      function days_30_360_bankers(fd, td) {
        // Use strict formula used earlier: year_diff*360 + month_diff*30 + day_diff
        const fy = fd.getFullYear(), fm = fd.getMonth()+1, fd_day = fd.getDate();
        const ty = td.getFullYear(), tm = td.getMonth()+1, td_day = td.getDate();
        const year_diff = ty - fy;
        const month_diff = tm - fm;
        const day_diff = td_day - fd_day;
        return year_diff*360 + month_diff*30 + day_diff;
      }

      // 30/360 US (NASD)
      function days_30_360_US(fd, td) {
        let d1 = fd.getDate(); let d2 = td.getDate();
        let m1 = fd.getMonth()+1; let m2 = td.getMonth()+1;
        let y1 = fd.getFullYear(); let y2 = td.getFullYear();

        if (d1 === 31) d1 = 30;
        if (d2 === 31 && d1 === 30) d2 = 30;
        return (y2 - y1)*360 + (m2 - m1)*30 + (d2 - d1);
      }

      // 30E/360 (European) - if either date is 31 -> set to 30
      function days_30E_360(fd, td) {
        let d1 = fd.getDate(); let d2 = td.getDate();
        if (d1 === 31) d1 = 30;
        if (d2 === 31) d2 = 30;
        const m1 = fd.getMonth()+1, m2 = td.getMonth()+1, y1 = fd.getFullYear(), y2 = td.getFullYear();
        return (y2 - y1)*360 + (m2 - m1)*30 + (d2 - d1);
      }

      // ACT/360, ACT/365, ACT/ACT
      function yearFraction_ACT360(fd, td) {
        const days = daysBetweenActual(fd, td);
        return days / 360;
      }
      function yearFraction_ACT365(fd, td) {
        const days = daysBetweenActual(fd, td);
        return days / 365;
      }
      function yearFraction_ACTACT(fd, td) {
        // Simplified: use actual/365 for typical practical use; (full ISDA requires splitting across leap years)
        const days = daysBetweenActual(fd, td);
        return days / 365;
      }

      // Indian Banking rule - many banks use 30/360; we'll use bankers variant
      function days_indian_banking(fd, td) {
        return days_30_360_bankers(fd, td);
      }

      // Compute yearFraction depending on method key
      function computeYearFraction(fd, td, methodKey) {
        switch (methodKey) {
          case 'bankers30_360':
            return days_30_360_bankers(fd, td) / 360;
          case 'us30_360':
            return days_30_360_US(fd, td) / 360;
          case 'euro30_360':
            return days_30E_360(fd, td) / 360;
          case 'actual_360':
            return yearFraction_ACT360(fd, td);
          case 'actual_365':
            return yearFraction_ACT365(fd, td);
          case 'act_act':
            return yearFraction_ACTACT(fd, td);
          case 'indian_bank':
            return days_indian_banking(fd, td) / 360;
          case 'custom_month':
            // custom: months = actual_days / 30 -> yearFraction = months/12
            const days = daysBetweenActual(fd, td);
            return (days / 30) / 12;
          default:
            return days_30_360_bankers(fd, td) / 360;
        }
      }

      function computeDaysForDisplay(fd, td, methodKey) {
        switch (methodKey) {
          case 'bankers30_360': return days_30_360_bankers(fd, td);
          case 'us30_360': return days_30_360_US(fd, td);
          case 'euro30_360': return days_30E_360(fd, td);
          case 'actual_360':
          case 'actual_365':
          case 'act_act': return daysBetweenActual(fd, td);
          case 'indian_bank': return days_indian_banking(fd, td);
          case 'custom_month': return daysBetweenActual(fd, td);
          default: return days_30_360_bankers(fd, td);
        }
      }

      // ---------- Main calculate function (keeps your original interest formula but supports many methods) ----------
      function fmtINR(n){ return '₹' + Number(n).toLocaleString('en-IN', {minimumFractionDigits:2, maximumFractionDigits:2}); }

      function calculate(){
        const loc = locales[localLang()] || locales.en;
        const t = loc;

        const amount = parseFloat(document.getElementById('amount').value);
        const rate = parseFloat(document.getElementById('rate').value);
        const fromVal = document.getElementById('fromDate').value;
        const toVal = document.getElementById('toDate').value;
        const method = document.getElementById('method').value;

        if (isNaN(amount) || amount < 0) { alert(t.alertInvalidAmount); return; }
        if (!fromVal || !toVal) { alert(t.alertSelectDates); return; }

        const fd = new Date(fromVal);
        const td = new Date(toVal);
        if (td < fd) { alert(t.alertToBeforeFrom); return; }

        // year fraction depending on method -> convert to months equivalent
        const yf = computeYearFraction(fd, td, method);
        const monthsEquivalent = yf * 12; // months = years * 12

        // interest: (amount / 100) * rate * monthsEquivalent
        const interest = (amount / 100) * (isNaN(rate) ? 0 : rate) * monthsEquivalent;
        const totalAmount = amount + interest;

        // days for display using method-specific rules
        const dispDays = computeDaysForDisplay(fd, td, method);
        const dispMonths = monthsEquivalent;

        // update UI
        document.getElementById('outDays').innerText = `${dispDays} ${t.daysSuffix}`;
        document.getElementById('outMonths').innerText = `${Number(dispMonths.toFixed(6))} ${t.monthsSuffix}`;
        document.getElementById('outRate').innerText = `₹${(isNaN(rate) ? 0 : rate).toFixed(2)}`;
        document.getElementById('outInterest').innerText = fmtINR(interest);
        document.getElementById('outTotal').innerText = fmtINR(totalAmount);

        // breakdown - translated labels, numeric values unchanged
        const lines = [];
        lines.push(`${t.amount}: ₹${Number(amount).toFixed(2)}`);
        lines.push(`${t.rate}: ₹${(isNaN(rate) ? 0 : rate).toFixed(2)} per ₹100 per month`);
        lines.push('');
        lines.push(`${t.fromLabel}: ${fd.getFullYear()}-${String(fd.getMonth()+1).padStart(2,'0')}-${String(fd.getDate()).padStart(2,'0')}`);
        lines.push(`${t.toLabel}:   ${td.getFullYear()}-${String(td.getMonth()+1).padStart(2,'0')}-${String(td.getDate()).padStart(2,'0')}`);
        lines.push('');
        lines.push(`${t.calculationLabel}`);
        lines.push(`Method: ${ (t.methods && t.methods[method]) ? t.methods[method] : method }`);
        lines.push('');
        // add method-specific detail
        lines.push(`year_fraction = ${yf.toFixed(8)} (years)`);
        lines.push(`months_equivalent = year_fraction * 12 = ${monthsEquivalent.toFixed(8)} (months)`);
        lines.push('');
        lines.push(`Interest = (Principal / 100) * rate * months_equivalent`);
        lines.push(`         = (${amount.toFixed(2)} / 100) * ${(isNaN(rate)?0:rate).toFixed(4)} * ${monthsEquivalent.toFixed(6)}`);
        lines.push(`         = ₹${interest.toFixed(2)}`);
        lines.push('');
        lines.push(`Total Amount = Principal + Interest = ₹${totalAmount.toFixed(2)}`);

        document.getElementById('breakdown').innerText = lines.join('\n');

        // smooth focus to results
        document.getElementById('outInterest').scrollIntoView({behavior:'smooth', block:'center'});
      }

      // wire actions & initializations
      document.getElementById('btnCalc').addEventListener('click', calculate);
      document.getElementById('btnReset').addEventListener('click', () => {
        document.getElementById('amount').value = '5000';
        document.getElementById('rate').value = '2';
        const today = new Date(); const in30 = new Date(); in30.setDate(today.getDate()+30);
        document.getElementById('fromDate').valueAsDate = today;
        document.getElementById('toDate').valueAsDate = in30;
        const t = locales[localLang()] || locales.en;
        document.getElementById('outDays').innerText = `0 ${t.daysSuffix}`;
        document.getElementById('outMonths').innerText = `0 ${t.monthsSuffix}`;
        document.getElementById('outInterest').innerText = '₹0.00';
        document.getElementById('outTotal').innerText = '₹0.00';
        document.getElementById('breakdown').innerText = '—';
      });

      // init sample dates & methods
      (function init(){
        const today = new Date(); const in30 = new Date(); in30.setDate(today.getDate()+30);
        document.getElementById('fromDate').valueAsDate = today;
        document.getElementById('toDate').valueAsDate = in30;
        // set language selector to en (already) and populate methods
        populateMethods();
        // set method default
        document.getElementById('method').value = 'bankers30_360';
        // set initial result placeholders
        const t = locales[localLang()] || locales.en;
        document.getElementById('outDays').innerText = `0 ${t.daysSuffix}`;
        document.getElementById('outMonths').innerText = `0 ${t.monthsSuffix}`;
        document.getElementById('outRate').innerText = `₹2.00`;
        document.getElementById('outInterest').innerText = '₹0.00';
        document.getElementById('outTotal').innerText = '₹0.00';
      })();

      // ensure when language changes we repopulate methods in that language
      document.getElementById('lang').addEventListener('change', (e) => {
        applyLang(e.target.value);
      });

    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
